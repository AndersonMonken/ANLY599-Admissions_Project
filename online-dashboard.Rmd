---
title: "Admission Statistics Analysis"
author: "Anderson Monken and Douglas Neumann"
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
    social: menu
    source_code: embed
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(flexdashboard)
library(plotly)
library(tidyverse)
library(rpart)
library(rattle)
library(tree)
library(visNetwork)

source('./data_cleaning.R')
```

Background
========================================================

Row
-------------------

### Inititial Decision Bar Graph
```{r}
# Simple Horizontal Bar Plot with Added Labels
counts <- table(df$Decision)
barplot(counts, main="Decision Distribution",
  xlab="Decision", col=c("Green","Red", "Blue"),
  legend = rownames(counts))
```

### GPA

```{r, echo = FALSE}
ggplotly(ggplot(data = df, aes(x = GPA)) + geom_density(aes(fill = Decision), alpha = 0.5) + theme_classic())
```

### Work Experience

```{r, echo = FALSE}
ggplotly(ggplot(data = df, aes(x = WorkExp)) + geom_density(aes(fill = Decision), alpha = 0.5) + theme_classic())
```


State Effects
========================================================

```{r, echo = FALSE}

state_order <- df %>% group_by(State) %>% tally()%>% arrange(n) %>% pull(State)

state_plot_data <- df %>% group_by(State, Decision) %>% tally() %>% mutate(Decision = factor(Decision, levels = c('Admit','Waitlist','Decline')), State = factor(State, state_order))

ggplotly(
  
ggplot(data = state_plot_data, 
       aes(x = State, y = n, color = Decision, fill = Decision)) + 
  geom_col() + 
  #theme_classic() + 
  coord_flip() + 
  scale_fill_manual(values = c('#F8766D','#619CFF','#00BA38'), breaks = c('Decline','Waitlist','Admit')) +
  scale_color_manual(values = c('#F8766D','#619CFF','#00BA38'), breaks = c('Decline','Waitlist','Admit')) +
  ggtitle("Admission Decision by State")
         
)
```

Score Effects
========================================================

### Test Score

```{r, echo = FALSE}
ggplotly(
  
  ggplot(data = df, aes(x = TestScore)) + 
    geom_density(aes(fill = Decision), alpha = 0.5) + 
    theme_classic()
)
```

### Writing Score

```{r, echo = FALSE}
ggplotly(
  
  ggplot(data = df, aes(x = WritingScore)) + 
    geom_density(aes(fill = Decision), alpha = 0.5) + 
    theme_classic()
)
```

Gender Effects
========================================================

```{r, echo = FALSE}
ggplotly(ggplot(data = df %>% group_by(Gender, Decision) %>% tally(), aes(x = Gender, y = n, color = Decision, fill = Decision)) + geom_col() + theme_classic())
```


Decision Tree
=========================================================


### Decision Tree

```{r, echo = FALSE}
tree_simple <- rpart(Decision ~ ., data=df, cp =0.000000005)
decision_tree_prez <- fancyRpartPlot(tree_simple, main = 'Decision Tree of Admissions\n\n', sub = NA)

visTree(tree_simple, main = "Decision Tree")

```
